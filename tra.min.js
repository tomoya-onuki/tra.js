!function(){"use strict";class t{_data=[];_startDate=0;_endDate=0;_weight=1;_rgb=[0,0,0];_lenMillis;_damping=1;_roundCap=!1;_ticks=0;_opacity=1;_thinning=1;_label="";_labelStyle={font:"Arial",size:10,color:"#000",offset:0};_animationRun=!0;constructor(){return this}fetch(t){return this._data=t,this._lenMillis=t[t.length-1].date-t[0].date,this._startDate=t[0].date,this._endDate=t[t.length-1].date,this}color(t,i,e){return this._rgb=[t,i,e],this}weight(t){return this._weight=t,this}thinning(t){return t>=1&&(t=1),t<0&&(t=0),this._thinning=t,this}length(t){return this._lenMillis=t,this}damping(t){return t>=1&&(t=1),t<0&&(t=0),this._damping=t,this}roundCap(t){return this._roundCap=Boolean(t),this}ticks(t){return this._ticks=t,this}opacity(t){return this._opacity=t,this}label(t){return this._label=t,this}labelStyle(t){return this._labelStyle=t,this}draw(t,i){if(!(this._data.length<1)&&!(i<this._startDate)){if(this._data.length>0){let s=t.getContext("2d"),l=a(0,this._data.length-1,i,this._data)-1,h=this._opacity,n=this._weight;if(0<=l&&l<this._data.length-1){let r=this._data[l].date,o=this._data[l].x,d=this._data[l].y,_=this._data[l+1].date,$=this._data[l+1].x,g=this._data[l+1].y,b=(i-r)/(_-r),f=(1-b)*o+b*$,y=(1-b)*d+b*g,u=o,p=d,c=i-r;if(c>this._lenMillis){let S=(c-this._lenMillis)/(_-r);u=(1-S)*o+S*$,p=(1-S)*d+S*g}else u=o,p=d;s.beginPath(),s.moveTo(f,y),s.lineTo(u,p),s.lineWidth=n,s.lineCap=this._roundCap?"round":"butt";let x=s.createLinearGradient(f,y,u,p);x.addColorStop(0,`rgba(${this._rgb[0]}, ${this._rgb[1]}, ${this._rgb[2]}, ${h})`),h*=this._damping,x.addColorStop(1,`rgba(${this._rgb[0]}, ${this._rgb[1]}, ${this._rgb[2]}, ${h})`),s.strokeStyle=x,s.stroke();let k=this._endDate;if(this._ticks>0){let m=-(.5*(g-d))*this._weight,w=.5*($-o)*this._weight;for(;k>r;){if(k<=i){let C=(k-r)/(_-r),M=(1-(C=Math.round(100*C)/100))*o+C*$,D=(1-C)*d+C*g;s.beginPath(),s.moveTo(M-m,D-w),s.lineTo(M+m,D+w),s.strokeStyle=`rgba(${this._rgb[0]}, ${this._rgb[1]}, ${this._rgb[2]}, ${h})`,s.lineWidth=1,s.stroke()}k-=this._ticks}}n*=this._thinning,this._lenMillis>=c&&e(s,l-1,this._data,this._rgb,h,n,this._roundCap,this._damping,this._thinning,this._lenMillis-c,k,this._ticks,i),this._label&&(s.font=`${this._labelStyle.size}pt ${this._labelStyle.font}`,s.fillStyle=this._labelStyle.color,s.fillText(this._label,f+this._labelStyle.offset,y+this._labelStyle.offset))}else{let T=this._endDate;l=this._data.length-2;let z=i-this._data[l].date;if(h*=this._damping,n*=this._thinning,this._lenMillis>=z&&(e(s,l-1,this._data,this._rgb,h,n,this._roundCap,this._damping,this._thinning,this._lenMillis-z,this._endDate,this._ticks,T),this._label)){let v=this._data[l].x,R=this._data[l].y;s.font=`${this._labelStyle.size}pt ${this._labelStyle.font}`,s.fillStyle=this._labelStyle.color,s.fillText(this._label,v+this._labelStyle.offset,R+this._labelStyle.offset)}}}return this}}start(){return this._animationRun=!0,this}pause(){return this._animationRun=!1,this}transition(t,i,e,s,a){let l=this,h=t.getContext("2d"),n=t.width,r=t.height,o=e;return setInterval(function(){h.clearRect(0,0,n,r),l.draw(t,o),l._animationRun&&(o+=i),a&&o>s&&(o=e)},i),this}}class i extends t{draw(t,i){if(!(this._data.length<1)&&!(i<this._startDate)){if(this._data.length>0){let e=a(0,this._data.length-1,i,this._data)-1,l=this._opacity,h=this._weight;if(0<=e&&e<this._data.length-1){let n=this._data[e].date,r=this._data[e].x,o=this._data[e].y,d=this._data[e+1].date,_=this._data[e+1].x,$=this._data[e+1].y,g=(i-n)/(d-n),b=(1-g)*r+g*_,f=(1-g)*o+g*$,y=r,u=o,p=i-n;if(p>this._lenMillis){let c=(p-this._lenMillis)/(d-n);y=(1-c)*r+c*_,u=(1-c)*o+c*$}else y=r,u=o;let S=`rgba(${this._rgb[0]}, ${this._rgb[1]}, ${this._rgb[2]}, ${l})`;this._rgb[0],this._rgb[1],this._rgb[2],l*=this._damping,t.append("line").attr("x1",b).attr("y1",f).attr("x2",y).attr("y2",u).attr("stroke-width",h).attr("stroke-linecap",this._roundCap?"round":"butt").attr("stroke",S);let x=this._endDate;if(this._ticks>0){let k=-(.5*($-o))*this._weight,m=.5*(_-r)*this._weight;for(;x>n;){if(x<=i){let w=(x-n)/(d-n),C=(1-(w=Math.round(100*w)/100))*r+w*_,M=(1-w)*o+w*$;t.append("line").attr("x1",C-k).attr("y1",M-m).attr("x2",C+k).attr("y2",M+m).attr("stroke-width",1).attr("stroke",`rgba(${this._rgb[0]}, ${this._rgb[1]}, ${this._rgb[2]}, ${l})`)}x-=this._ticks}}h*=this._thinning,this._lenMillis>=p&&s(t,e-1,this._data,this._rgb,l,h,this._roundCap,this._damping,this._thinning,this._lenMillis-p,x,this._ticks,i),this._label&&t.append("text").attr("x",b+this._labelStyle.offset).attr("y",f+this._labelStyle.offset).attr("font-family",this._labelStyle.font).attr("font-size",`${this._labelStyle.size}pt`).attr("fill",this._labelStyle.color).text(this._label)}else{let D=this._endDate;e=this._data.length-2;let T=i-this._data[e].date;if(l*=this._damping,h*=this._thinning,this._lenMillis>=T&&(s(t,e-1,this._data,this._rgb,l,h,this._roundCap,this._damping,this._thinning,this._lenMillis-T,this._endDate,this._ticks,D),this._label)){let z=this._data[e].x,v=this._data[e].y;t.append("text").attr("x",z+this._labelStyle.offset).attr("y",v+this._labelStyle.offset).attr("font-family",this._labelStyle.font).attr("font-size",`${this._labelStyle.size}pt`).attr("fill",this._labelStyle.color).text(this._label)}}}return this}}transition(t,i,e,s,a){let l=this,h=e;return setInterval(function(){t.selectAll("line").remove(),t.selectAll("text").remove(),l.draw(t,h),l._animationRun&&(h+=i),a&&h>s&&(h=e)},i),this}}function e(t,i,s,a,l,h,n,r,o,d,_,$,g){if(0<=i){let b=s[i].date,f=s[i].x,y=s[i].y,u=s[i+1].date,p=s[i+1].x,c=s[i+1].y,S=p,x=c,k=f,m=y,w=u-b;if(w>d){let C=(w-d)/(u-b);k=(1-C)*f+C*p,m=(1-C)*y+C*c}else k=f,m=y;t.beginPath(),t.moveTo(S,x),t.lineTo(k,m),t.lineWidth=h,t.lineCap=n?"round":"butt";let M=t.createLinearGradient(S,x,k,m);M.addColorStop(0,`rgba(${a[0]}, ${a[1]}, ${a[2]}, ${l})`),l*=r,M.addColorStop(1,`rgba(${a[0]}, ${a[1]}, ${a[2]}, ${l})`),t.strokeStyle=M,t.stroke();let D=w>d?u-d:b;if($>0){let T=-(.5*(c-y))*h,z=.5*(p-f)*h;for(;_>D;){if(_<=g){let v=(_-b)/(u-b),R=(1-(v=Math.round(100*v)/100))*f+v*p,P=(1-v)*y+v*c;t.beginPath(),t.moveTo(R-T,P-z),t.lineTo(R+T,P+z),t.lineWidth=1,t.strokeStyle=`rgba(${a[0]}, ${a[1]}, ${a[2]}, ${l})`,t.stroke()}_-=$}}h*=o,d>=w&&e(t,i-1,s,a,l,h,n,r,o,d-w,_,$,g)}}function s(t,i,e,a,l,h,n,r,o,d,_,$,g){if(0<=i){let b=e[i].date,f=e[i].x,y=e[i].y,u=e[i+1].date,p=e[i+1].x,c=e[i+1].y,S=f,x=y,k=u-b;if(k>d){let m=(k-d)/(u-b);S=(1-m)*f+m*p,x=(1-m)*y+m*c}else S=f,x=y;let w=`rgba(${a[0]}, ${a[1]}, ${a[2]}, ${l})`;a[0],a[1],a[2],l*=r,t.append("line").attr("x1",p).attr("y1",c).attr("x2",S).attr("y2",x).attr("stroke-width",h).attr("stroke-linecap",n?"round":"butt").attr("stroke",w);let C=k>d?u-d:b;if($>0){let M=-(.5*(c-y))*h,D=.5*(p-f)*h;for(;_>C;){if(_<=g){let T=(_-b)/(u-b),z=(1-(T=Math.round(100*T)/100))*f+T*p,v=(1-T)*y+T*c;t.append("line").attr("x1",z-M).attr("y1",v-D).attr("x2",z+M).attr("y2",v+D).attr("stroke-width",1).attr("stroke",`rgba(${a[0]}, ${a[1]}, ${a[2]}, ${l})`)}_-=$}}h*=o,d>=k&&s(t,i-1,e,a,l,h,n,r,o,d-k,_,$,g)}}function a(t,i,e,s){if(!(t<=i))return t;{let l=Math.ceil(t+(i-t)/2),h=s[l].date;return h>e?a(t,l-1,e,s):h<e?a(l+1,i,e,s):l}}"undefined"==typeof module?(self.Trajs=t,self.TrajsD3=i):(module.exports=t,module.exports=i)}();